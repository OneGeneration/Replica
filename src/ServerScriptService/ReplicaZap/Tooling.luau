--!native
--!optimize 2
--!nocheck
--!nolint
--#selene: allow(if_same_then_else, unused_variable)
-- Tooling generated by Zap v0.6.20 (https://github.com/red-blox/zap)
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- thanks to https://dom.rojo.space/binary.html#cframe
local CFrameSpecialCases = {
	CFrame.Angles(0, 0, 0),
	CFrame.Angles(math.rad(90), 0, 0),
	CFrame.Angles(0, math.rad(180), math.rad(180)),
	CFrame.Angles(math.rad(-90), 0, 0),
	CFrame.Angles(0, math.rad(180), math.rad(90)),
	CFrame.Angles(0, math.rad(90), math.rad(90)),
	CFrame.Angles(0, 0, math.rad(90)),
	CFrame.Angles(0, math.rad(-90), math.rad(90)),
	CFrame.Angles(math.rad(-90), math.rad(-90), 0),
	CFrame.Angles(0, math.rad(-90), 0),
	CFrame.Angles(math.rad(90), math.rad(-90), 0),
	CFrame.Angles(0, math.rad(90), math.rad(180)),
	CFrame.Angles(0, math.rad(-90), math.rad(180)),
	CFrame.Angles(0, math.rad(180), math.rad(0)),
	CFrame.Angles(math.rad(-90), math.rad(-180), math.rad(0)),
	CFrame.Angles(0, math.rad(0), math.rad(180)),
	CFrame.Angles(math.rad(90), math.rad(180), math.rad(0)),
	CFrame.Angles(0, math.rad(0), math.rad(-90)),
	CFrame.Angles(0, math.rad(-90), math.rad(-90)),
	CFrame.Angles(0, math.rad(-180), math.rad(-90)),
	CFrame.Angles(0, math.rad(90), math.rad(-90)),
	CFrame.Angles(math.rad(90), math.rad(90), 0),
	CFrame.Angles(0, math.rad(90), 0),
	CFrame.Angles(math.rad(-90), math.rad(90), 0),
}

return function(remote_instance, player, incoming_buff, incoming_inst)
	local remotes = ReplicatedStorage:FindFirstChild("ZAP")
	if not remotes then
		return
	end

	local reliable = remotes:FindFirstChild("REPLICA_ZAP_RELIABLE")


	if not reliable then
		return
	end

	if remote_instance ~= reliable then
		return
	end

	local isServer = true
	if type(player) == "buffer" then
		isServer = false
		incoming_inst = incoming_buff
		incoming_buff = player
		player = nil
	end

	local incoming_read = 0
	local incoming_ipos = 0
	local function read(len: number)
		local pos = incoming_read
		incoming_read = incoming_read + len

		return pos
	end
	local len = buffer.len(incoming_buff)

	local types = {}
	function types.read_ReplicaId()
		local value;
		value = buffer.readu8(incoming_buff, read(1))
		return value
	end
	function types.read_Path()
		local value;
		value = {}
		local len_1 = buffer.readu16(incoming_buff, read(2))
		for i_1 = 1, len_1 do
			local val_1
			local len_2 = buffer.readu16(incoming_buff, read(2))
			val_1 = buffer.readstring(incoming_buff, read(len_2), len_2)
			value[i_1] = val_1
		end
		return value
	end

	local events = {}
	while incoming_read < len do
		if isServer and remote_instance == reliable then
			local id = buffer.readu8(incoming_buff, read(1))
			if id == 0 then
				table.insert(events, {
					Name = "RequestData",
					Arguments = {  }
				})
			elseif id == 1 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["params"] = {}
				local len_1 = buffer.readu16(incoming_buff, read(2))
				for i_1 = 1, len_1 do
					local val_1
					if buffer.readu8(incoming_buff, read(1)) == 1 then
						incoming_ipos = incoming_ipos + 1
						val_1 = incoming_inst[incoming_ipos]
					else
						val_1 = nil
					end
					value["params"][i_1] = val_1
				end
				table.insert(events, {
					Name = "ClientSignal",
					Arguments = { value }
				})
			else
				error("Unknown event id")
			end
		elseif not isServer and remote_instance == reliable then
			local id = buffer.readu8(incoming_buff, read(1))
			if id == 0 then
				table.insert(events, {
					Name = "InitialDataRecieved",
					Arguments = {  }
				})
			elseif id == 1 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["path"] = types.read_Path()
				if buffer.readu8(incoming_buff, read(1)) == 1 then
					incoming_ipos = incoming_ipos + 1
					value["value"] = incoming_inst[incoming_ipos]
				else
					value["value"] = nil
				end
				table.insert(events, {
					Name = "Set",
					Arguments = { value }
				})
			elseif id == 2 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["path"] = types.read_Path()
				value["values"] = {}
				for _ = 1, buffer.readu16(incoming_buff, read(2)) do
					local key_1
					local val_2
					local len_2 = buffer.readu16(incoming_buff, read(2))
					key_1 = buffer.readstring(incoming_buff, read(len_2), len_2)
					if buffer.readu8(incoming_buff, read(1)) == 1 then
						incoming_ipos = incoming_ipos + 1
						val_2 = incoming_inst[incoming_ipos]
					else
						val_2 = nil
					end
					value["values"][key_1] = val_2
				end
				table.insert(events, {
					Name = "SetValues",
					Arguments = { value }
				})
			elseif id == 3 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["path"] = types.read_Path()
				if buffer.readu8(incoming_buff, read(1)) == 1 then
					incoming_ipos = incoming_ipos + 1
					value["value"] = incoming_inst[incoming_ipos]
				else
					value["value"] = nil
				end
				if buffer.readu8(incoming_buff, read(1)) == 1 then
					value["index"] = buffer.readu32(incoming_buff, read(4))
				else
					value["index"] = nil
				end
				table.insert(events, {
					Name = "TableInsert",
					Arguments = { value }
				})
			elseif id == 4 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["path"] = types.read_Path()
				value["index"] = buffer.readu32(incoming_buff, read(4))
				table.insert(events, {
					Name = "TableRemove",
					Arguments = { value }
				})
			elseif id == 5 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				if buffer.readu8(incoming_buff, read(1)) == 1 then
					incoming_ipos = incoming_ipos + 1
					value["func_id"] = incoming_inst[incoming_ipos]
				else
					value["func_id"] = nil
				end
				value["params"] = {}
				local len_3 = buffer.readu16(incoming_buff, read(2))
				for i_2 = 1, len_3 do
					local val_3
					if buffer.readu8(incoming_buff, read(1)) == 1 then
						incoming_ipos = incoming_ipos + 1
						val_3 = incoming_inst[incoming_ipos]
					else
						val_3 = nil
					end
					value["params"][i_2] = val_3
				end
				table.insert(events, {
					Name = "Write",
					Arguments = { value }
				})
			elseif id == 6 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["params"] = {}
				local len_4 = buffer.readu16(incoming_buff, read(2))
				for i_3 = 1, len_4 do
					local val_4
					if buffer.readu8(incoming_buff, read(1)) == 1 then
						incoming_ipos = incoming_ipos + 1
						val_4 = incoming_inst[incoming_ipos]
					else
						val_4 = nil
					end
					value["params"][i_3] = val_4
				end
				table.insert(events, {
					Name = "ServerSignal",
					Arguments = { value }
				})
			elseif id == 7 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				value["parent_id"] = types.read_ReplicaId()
				table.insert(events, {
					Name = "Parent",
					Arguments = { value }
				})
			elseif id == 8 then
				local value
				value = {}
				if buffer.readu8(incoming_buff, read(1)) == 1 then
					incoming_ipos = incoming_ipos + 1
					value["creation"] = incoming_inst[incoming_ipos]
				else
					value["creation"] = nil
				end
				if buffer.readu8(incoming_buff, read(1)) == 1 then
					value["root_id"] = types.read_ReplicaId()
				else
					value["root_id"] = nil
				end
				table.insert(events, {
					Name = "Create",
					Arguments = { value }
				})
			elseif id == 9 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				table.insert(events, {
					Name = "Bind",
					Arguments = { value }
				})
			elseif id == 10 then
				local value
				value = {}
				value["replica_id"] = types.read_ReplicaId()
				table.insert(events, {
					Name = "Destroy",
					Arguments = { value }
				})
			else
				error("Unknown event id")
			end
		end
	end

	return events
end
